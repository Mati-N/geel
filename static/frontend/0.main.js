(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,t,n){"use strict";n.r(t);var a=n(103),r=n.n(a),o=n(40),c=n.n(o),l=n(21),s=n.n(l),i=n(0),m=n.n(i),u=n(8),p=n(30),f=n(22),d=n(32);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=Object(i.lazy)((function(){return n.e(14).then(n.bind(null,120))})),O=Object(i.lazy)((function(){return n.e(13).then(n.bind(null,121))})),g=Object(i.lazy)((function(){return n.e(12).then(n.bind(null,122))}));t.default=function(e){var t=e.text,n=e.title,a=e.username,o=e.id,c=e.likes,l=e.creation,b=e.user_id,y={done:!1,likes:c,hasMore:!1,height:"32vh",loading:!1,comments:e.comments,expand:!1},k=Object(u.useLazyQuery)(p.i,{variables:{post_id:o},onCompleted:function(e){F(h(h({},J),{},{liked:e.liked}))}}),E=s()(k,1)[0],j=Object(i.useState)(!1),x=s()(j,2),N=x[0],M=x[1],w=Object(i.useState)(""),C=s()(w,2),P=C[0],H=C[1],S=Object(i.useRef)(null),D=Object(u.useMutation)(p.h),_=s()(D,1)[0],z=Object(u.useMutation)(p.b),L=s()(z,1)[0],Q=Object(i.useState)(y),q=s()(Q,2),J=q[0],F=q[1],R=Object(d.c)({to:{maxHeight:J.expand?"".concat(S.current.scrollHeight,"px"):"230px",height:J.expand?"".concat(S.current.scrollHeight,"px"):"230px"},from:{maxHeight:J.expand?"".concat(S.current.scrollHeight,"px"):"230px",height:J.expand?"".concat(S.current.scrollHeight,"px"):"230px"},duration:"1s"});Object(i.useEffect)((function(){E(),F(h(h({},J),{},{hasMore:S.current.scrollHeight>S.current.clientHeight,loading:!1}))}),[]);return m.a.createElement("div",{className:"post card"},m.a.createElement("div",{className:"post-top card-top"},m.a.createElement("div",{className:"post-info-top"},m.a.createElement(f.Link,{to:"user/".concat(b),className:"post-user"}," ",a," "),m.a.createElement("small",{className:"post-time"},function(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var a=Math.floor(n);return Math.floor(n)+(1===a?" year":" years")}if((n=t/2592e3)>1){var r=Math.floor(n);return r+(1===r?" month":" months")}if((n=t/86400)>1){var o=Math.floor(n);return Math.floor(o)+(1===o?" day":" days")}if((n=t/3600)>1){var c=Math.floor(n);return c+(1===c?" hour":" hours")}if((n=t/60)>1){var l=Math.floor(n);return l+(1==l?" minute":" minutes")}return"Seconds"}(new Date(l))," ago"," ")),m.a.createElement("h5",{className:"post-title"},n)),m.a.createElement(d.a.pre,{ref:S,className:"post-text",style:J.hasMore?R:{}},t,J.hasMore&&m.a.createElement("button",{className:"more",onClick:function(){F(h(h({},J),{},{expand:!J.expand}))}},J.expand?"less":"more")),!J.loading&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"info-bottom"},m.a.createElement("span",{className:"like",onClick:function(){_({variables:{post_id:o}}).catch((function(e){return console.log(e)})).then((function(e){var t=e.data.likePost;F(h(h({},J),{},{liked:!J.liked,likes:t.post.likers.length}))}))},onMouseOver:function(){return M(!0)},onMouseOut:function(){return M(!1)}},N?J.liked?m.a.createElement(O,{className:"like-icon"}):m.a.createElement(v,{className:"like-icon"}):J.liked?m.a.createElement(v,{className:"like-icon"}):m.a.createElement(O,{className:"like-icon"}),J.likes>0&&J.likes),m.a.createElement("span",{className:"like"},m.a.createElement(f.Link,{to:"/post/".concat(o),className:"like-icon"},m.a.createElement(g,null)),J.comments>0&&J.comments)),m.a.createElement("span",{className:"comment-form"},m.a.createElement("form",{onSubmit:function(){L({variables:{id:o,content:P},update:function(e,t){var n=t.data;if(e){var a=e.readQuery({query:p.e,variables:{id:o}}).postComments;if(a){var c=h(h({},a),{},{edges:[{__typename:"CommentNodeConnection",node:n.createComment.comment}].concat(r()(a.edges))});e.writeQuery({query:p.e,variables:{id:o},data:{postComments:c}})}}}})}},m.a.createElement("div",{className:"form-group comment-form"},m.a.createElement("input",{class:"form-control",type:"text",id:"comment",name:"text",value:P,onChange:function(e){return H(e.target.value)}}),m.a.createElement("button",{class:"btn btn-outline-primary",type:"submit",id:"btn"},"Comment"))))))}}}]);
//# sourceMappingURL=0.main.js.map