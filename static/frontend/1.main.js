(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./src/components/post/PostItem.js":
/*!*****************************************!*\
  !*** ./src/components/post/PostItem.js ***!
  \*****************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/defineProperty.js");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ "./node_modules/@babel/runtime/helpers/slicedToArray.js");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _apollo_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @apollo/client */ "./node_modules/@apollo/client/index.js");\n/* harmony import */ var _Queries__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../Queries */ "./src/Queries.js");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/esm/react-router-dom.js");\n/* harmony import */ var react_spring__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-spring */ "./node_modules/react-spring/web.js");\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\n\n\n\n\nvar Liked = /*#__PURE__*/Object(react__WEBPACK_IMPORTED_MODULE_2__["lazy"])(function () {\n  return __webpack_require__.e(/*! import() */ 7).then(__webpack_require__.bind(null, /*! ../SVG/Like.svg */ "./src/components/SVG/Like.svg"));\n});\nvar Heart = /*#__PURE__*/Object(react__WEBPACK_IMPORTED_MODULE_2__["lazy"])(function () {\n  return __webpack_require__.e(/*! import() */ 6).then(__webpack_require__.bind(null, /*! ../SVG/Heart.svg */ "./src/components/SVG/Heart.svg"));\n});\nvar Comments = /*#__PURE__*/Object(react__WEBPACK_IMPORTED_MODULE_2__["lazy"])(function () {\n  return __webpack_require__.e(/*! import() */ 5).then(__webpack_require__.bind(null, /*! ../SVG/Comments.svg */ "./src/components/SVG/Comments.svg"));\n});\n\nvar PostItem = function PostItem(_ref) {\n  var text = _ref.text,\n      title = _ref.title,\n      username = _ref.username,\n      id = _ref.id,\n      likes = _ref.likes,\n      creation = _ref.creation,\n      user_id = _ref.user_id,\n      comments = _ref.comments;\n  var initialState = {\n    done: false,\n    likes: likes,\n    hasMore: false,\n    height: "32vh",\n    loading: false,\n    comments: comments\n  };\n\n  var _useLazyQuery = Object(_apollo_client__WEBPACK_IMPORTED_MODULE_3__["useLazyQuery"])(_Queries__WEBPACK_IMPORTED_MODULE_4__["LIKED"], {\n    variables: {\n      post_id: id\n    },\n    onCompleted: function onCompleted(data) {\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        liked: data.liked\n      }));\n    }\n  }),\n      _useLazyQuery2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_useLazyQuery, 1),\n      liked = _useLazyQuery2[0];\n\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_2__["useState"])(false),\n      _useState2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_useState, 2),\n      hovered = _useState2[0],\n      setHovered = _useState2[1];\n\n  var self = Object(react__WEBPACK_IMPORTED_MODULE_2__["useRef"])(null);\n\n  var _useMutation = Object(_apollo_client__WEBPACK_IMPORTED_MODULE_3__["useMutation"])(_Queries__WEBPACK_IMPORTED_MODULE_4__["LIKE"]),\n      _useMutation2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_useMutation, 1),\n      likePost = _useMutation2[0];\n\n  var _useState3 = Object(react__WEBPACK_IMPORTED_MODULE_2__["useState"])(initialState),\n      _useState4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_useState3, 2),\n      state = _useState4[0],\n      setState = _useState4[1];\n\n  var expandText = Object(react_spring__WEBPACK_IMPORTED_MODULE_6__["useSpring"])({\n    to: {\n      maxHeight: state.expand ? "".concat(self.current.scrollHeight, "px") : "230px",\n      height: state.expand ? "".concat(self.current.scrollHeight, "px") : "230px"\n    },\n    from: {\n      maxHeight: !state.expand ? "230px" : "".concat(self.current.scrollHeight, "px"),\n      height: !state.expand ? "230px" : "".concat(self.current.scrollHeight, "px")\n    },\n    duration: "1s"\n  });\n  Object(react__WEBPACK_IMPORTED_MODULE_2__["useEffect"])(function () {\n    liked();\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      hasMore: self.current.scrollHeight > self.current.clientHeight,\n      loading: false\n    }));\n  }, []);\n\n  var timeSince = function timeSince(date) {\n    var seconds = Math.floor((new Date() - date) / 1000);\n    var interval = seconds / 31536000;\n\n    if (interval > 1) {\n      var flr = Math.floor(interval);\n      return Math.floor(interval) + (flr === 1 ? " year" : " years");\n    }\n\n    interval = seconds / 2592000;\n\n    if (interval > 1) {\n      var _flr = Math.floor(interval);\n\n      return _flr + (_flr === 1 ? " month" : " months");\n    }\n\n    interval = seconds / 86400;\n\n    if (interval > 1) {\n      var _flr2 = Math.floor(interval);\n\n      return Math.floor(_flr2) + (_flr2 === 1 ? " day" : " days");\n    }\n\n    interval = seconds / 3600;\n\n    if (interval > 1) {\n      var _flr3 = Math.floor(interval);\n\n      return _flr3 + (_flr3 === 1 ? " hour" : " hours");\n    }\n\n    interval = seconds / 60;\n\n    if (interval > 1) {\n      var _flr4 = Math.floor(interval);\n\n      return _flr4 + (_flr4 == 1 ? " minute" : " minutes");\n    }\n\n    return "Seconds";\n  };\n\n  var like = function like() {\n    likePost({\n      variables: {\n        post_id: id\n      }\n    })["catch"](function (error) {\n      return console.log(error);\n    }).then(function (_ref2) {\n      var likePost = _ref2.data.likePost;\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        liked: !state.liked,\n        likes: likePost.post.likers.length\n      }));\n    });\n  };\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div", {\n    className: "post card"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div", {\n    className: "post-top card-top"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div", {\n    className: "post-info-top"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], {\n    to: "user/".concat(user_id),\n    className: "post-user"\n  }, " ", username, " "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("small", {\n    className: "post-time"\n  }, timeSince(new Date(creation)), " ago", " ")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("h5", {\n    className: "post-title"\n  }, title)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react_spring__WEBPACK_IMPORTED_MODULE_6__["animated"].pre, {\n    ref: self,\n    className: "post-text",\n    style: state.hasMore ? expandText : {}\n  }, text, state.hasMore && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button", {\n    className: "more",\n    onClick: function onClick() {\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        expand: !state.expand\n      }));\n    }\n  }, state.expand ? "less" : "more")), !state.loading && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div", {\n    className: "info-bottom"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("span", {\n    className: "like",\n    onClick: function onClick() {\n      like();\n    },\n    onMouseOver: function onMouseOver() {\n      return setHovered(true);\n    },\n    onMouseOut: function onMouseOut() {\n      return setHovered(false);\n    }\n  }, !hovered ? state.liked ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Liked, {\n    className: "like-icon"\n  }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Heart, {\n    className: "like-icon"\n  }) : !state.liked ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Liked, {\n    className: "like-icon"\n  }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Heart, {\n    className: "like-icon"\n  }), state.likes > 0 && state.likes), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("span", {\n    className: "like"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], {\n    to: "/post/".concat(id),\n    className: "like-icon"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Comments, null)), state.comments > 0 && state.comments)));\n};\n\n/* harmony default export */ __webpack_exports__["default"] = (PostItem);\n\n//# sourceURL=webpack:///./src/components/post/PostItem.js?')}}]);