(window.webpackJsonp=window.webpackJsonp||[]).push([[11,0],{109:function(e,t,n){"use strict";n.r(t);var r=n(40),a=n.n(r),o=n(21),c=n.n(o),s=n(0),l=n.n(s),i=n(8),u=n(30),m=n(22),p=n(32);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=Object(s.lazy)((function(){return n.e(14).then(n.bind(null,120))})),b=Object(s.lazy)((function(){return n.e(13).then(n.bind(null,121))})),g=Object(s.lazy)((function(){return n.e(12).then(n.bind(null,122))}));t.default=function(e){var t=e.text,n=e.title,r=e.username,a=e.id,o=e.likes,f=e.creation,O=e.user_id,y={done:!1,likes:o,hasMore:!1,height:"32vh",loading:!1,comments:e.comments},E=Object(i.useLazyQuery)(u.h,{variables:{post_id:a},onCompleted:function(e){H(d(d({},D),{},{liked:e.liked}))}}),v=c()(E,1)[0],k=Object(s.useState)(!1),j=c()(k,2),w=j[0],x=j[1],N=Object(s.useRef)(null),P=Object(i.useMutation)(u.g),M=c()(P,1)[0],C=Object(s.useState)(y),S=c()(C,2),D=S[0],H=S[1],_=Object(p.c)({to:{maxHeight:D.expand?"".concat(N.current.scrollHeight,"px"):"230px",height:D.expand?"".concat(N.current.scrollHeight,"px"):"230px"},from:{maxHeight:D.expand?"".concat(N.current.scrollHeight,"px"):"230px",height:D.expand?"".concat(N.current.scrollHeight,"px"):"230px"},duration:"1s"});Object(s.useEffect)((function(){v(),H(d(d({},D),{},{hasMore:N.current.scrollHeight>N.current.clientHeight,loading:!1}))}),[]);return l.a.createElement("div",{className:"post card"},l.a.createElement("div",{className:"post-top card-top"},l.a.createElement("div",{className:"post-info-top"},l.a.createElement(m.Link,{to:"user/".concat(O),className:"post-user"}," ",r," "),l.a.createElement("small",{className:"post-time"},function(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var r=Math.floor(n);return Math.floor(n)+(1===r?" year":" years")}if((n=t/2592e3)>1){var a=Math.floor(n);return a+(1===a?" month":" months")}if((n=t/86400)>1){var o=Math.floor(n);return Math.floor(o)+(1===o?" day":" days")}if((n=t/3600)>1){var c=Math.floor(n);return c+(1===c?" hour":" hours")}if((n=t/60)>1){var s=Math.floor(n);return s+(1==s?" minute":" minutes")}return"Seconds"}(new Date(f))," ago"," ")),l.a.createElement("h5",{className:"post-title"},n)),l.a.createElement(p.a.pre,{ref:N,className:"post-text",style:D.hasMore?_:{}},t,D.hasMore&&l.a.createElement("button",{className:"more",onClick:function(){H(d(d({},D),{},{expand:!D.expand}))}},D.expand?"less":"more")),!D.loading&&l.a.createElement("div",{className:"info-bottom"},l.a.createElement("span",{className:"like",onClick:function(){M({variables:{post_id:a}}).catch((function(e){return console.log(e)})).then((function(e){var t=e.data.likePost;H(d(d({},D),{},{liked:!D.liked,likes:t.post.likers.length}))}))},onMouseOver:function(){return x(!0)},onMouseOut:function(){return x(!1)}},w?D.liked?l.a.createElement(b,{className:"like-icon"}):l.a.createElement(h,{className:"like-icon"}):D.liked?l.a.createElement(h,{className:"like-icon"}):l.a.createElement(b,{className:"like-icon"}),D.likes>0&&D.likes),l.a.createElement("span",{className:"like"},l.a.createElement(m.Link,{to:"/post/".concat(a),className:"like-icon"},l.a.createElement(g,null)),D.comments>0&&D.comments)))}},119:function(e,t,n){"use strict";n.r(t);var r=n(41),a=n.n(r),o=n(103),c=n.n(o),s=n(40),l=n.n(s),i=n(21),u=n.n(i),m=n(0),p=n.n(m),f=n(107),d=n(8),h=n(30),b=n(33),g=n(111);var O=function(e){e.error;var t=e.componentStack,n=e.resetErrorBoundary;return p.a.createElement("div",{role:"alert"},p.a.createElement("p",null,"Something went wrong:"),p.a.createElement("pre",null,t),p.a.createElement("button",{className:"btn-teal btn",onClick:n},"Try again"))},y=n(109);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.match.params.id,n=Object(d.useQuery)(h.d,{variables:{id:t}}),r=n.loading,o=n.data,s=(n.error,n.fetchMore),l=(n.refetch,Object(m.useState)(!0)),i=u()(l,2),E=i[0],k=i[1];if(r&&!o)return p.a.createElement(b.ImpulseSpinner,{size:40});var j=o.posts.edges[0].node;return p.a.createElement(g.ErrorBoundary,{FallbackComponent:O},p.a.createElement("div",{className:"main"},p.a.createElement(y.default,a()({key:j.id,likes:j.likers.length,comments:j.commentSet.length,user_id:j.user.id,username:j.user.username},j)),o.postComments.edges.map((function(e){var t=e.node;return p.a.createElement(p.a.Fragment,null,p.a.createElement("span",null,p.a.createElement("span",null,"node.user.username"),p.a.createElement(Link,{to:"post/".concat(t.user.id)})),p.a.createElement("h1",null,"node.content"))})),p.a.createElement(f.a,{onEnter:function(){s({query:h.d,variables:{cursor:o.post.postComments.pageInfo.endCursor},updateQuery:function(e,t){var n=t.fetchMoreResult;if(k(!0),!e.post.postComments.pageInfo.hasNextPage)return k(!1),e;var r=n.post.postComments.edges,a=n.post.postComments.pageInfo;return r.length?{post:v(v({},e.post),{},{postComments:{__typename:e.post.postComments.__typename,edges:[].concat(c()(e.post.posts.edges),c()(r)),pageInfo:a}})}:e}})}},p.a.createElement("div",{className:"spinner"},(r||E)&&p.a.createElement(b.ImpulseSpinner,{size:40})))))}}}]);
//# sourceMappingURL=11.main.js.map