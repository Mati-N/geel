(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"./src/components/post/PostItem.js":
/*!*****************************************!*\
  !*** ./src/components/post/PostItem.js ***!
  \*****************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var a=n(/*! @babel/runtime/helpers/toConsumableArray */"./node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n(/*! @babel/runtime/helpers/defineProperty */"./node_modules/@babel/runtime/helpers/defineProperty.js"),s=n.n(o),c=n(/*! @babel/runtime/helpers/slicedToArray */"./node_modules/@babel/runtime/helpers/slicedToArray.js"),l=n.n(c),i=n(/*! react */"./node_modules/react/index.js"),m=n.n(i),u=n(/*! @apollo/client */"./node_modules/@apollo/client/index.js"),d=n(/*! ../../Queries */"./src/Queries.js"),p=n(/*! react-router-dom */"./node_modules/react-router-dom/esm/react-router-dom.js"),f=n(/*! react-spring */"./node_modules/react-spring/web.js");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=Object(i.lazy)((function(){return n.e(/*! import() */11).then(n.bind(null,/*! ../SVG/Like.svg */"./src/components/SVG/Like.svg"))})),v=Object(i.lazy)((function(){return n.e(/*! import() */10).then(n.bind(null,/*! ../SVG/Heart.svg */"./src/components/SVG/Heart.svg"))})),O=Object(i.lazy)((function(){return n.e(/*! import() */9).then(n.bind(null,/*! ../SVG/Comments.svg */"./src/components/SVG/Comments.svg"))}));t.default=function(e){var t=e.text,n=e.title,a=e.username,o=e.id,s=e.likeCount,c=e.createdAt,b=e.user_id,j=e.comment_count,E=e.show_comment,y={done:!1,likes:s,hasMore:!1,height:"32vh",loading:!1,comments:j,expand:!1},k=Object(u.useLazyQuery)(d.LIKED,{variables:{post_id:o},onCompleted:function(e){V(h(h({},I),{},{liked:e.liked}))}}),x=l()(k,1)[0],N=Object(i.useState)(!1),M=l()(N,2),w=M[0],_=M[1],C=Object(i.useState)(""),P=l()(C,2),S=P[0],H=P[1],D=Object(i.useRef)(null),T=Object(u.useMutation)(d.LIKE),L=l()(T,1)[0],G=Object(u.useMutation)(d.CREATE_COMMENT),z=l()(G,1)[0],A=Object(i.useState)(y),Q=l()(A,2),I=Q[0],V=Q[1],q=Object(f.useSpring)({to:{maxHeight:I.expand?"".concat(D.current.scrollHeight,"px"):"230px",height:I.expand?"".concat(D.current.scrollHeight,"px"):"230px"},from:{maxHeight:I.expand?"".concat(D.current.scrollHeight,"px"):"230px",height:I.expand?"".concat(D.current.scrollHeight,"px"):"230px"},duration:"1s"});Object(i.useEffect)((function(){x(),V(h(h({},I),{},{hasMore:D.current.scrollHeight>D.current.clientHeight,loading:!1}))}),[]);return m.a.createElement("div",{className:"post card"},m.a.createElement("div",{className:"post-top card-top"},m.a.createElement("div",{className:"post-info-top"},m.a.createElement(p.Link,{to:"user/".concat(b),className:"post-user"}," ",a," "),m.a.createElement("small",{className:"post-time"},function(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var a=Math.floor(n);return Math.floor(n)+(1===a?" year":" years")}if((n=t/2592e3)>1){var r=Math.floor(n);return r+(1===r?" month":" months")}if((n=t/86400)>1){var o=Math.floor(n);return Math.floor(o)+(1===o?" day":" days")}if((n=t/3600)>1){var s=Math.floor(n);return s+(1===s?" hour":" hours")}if((n=t/60)>1){var c=Math.floor(n);return c+(1==c?" minute":" minutes")}return"Seconds"}(new Date(c))," ago"," ")),m.a.createElement("h5",{className:"post-title"},n)),m.a.createElement(f.animated.pre,{ref:D,className:"post-text",style:I.hasMore?q:{}},t,I.hasMore&&m.a.createElement("button",{className:"more",onClick:function(){V(h(h({},I),{},{expand:!I.expand}))}},I.expand?"less":"more")),!I.loading&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"info-bottom"},m.a.createElement("span",{className:"like",onClick:function(){L({variables:{post_id:o}}).catch((function(e){return console.log(e)})).then((function(e){var t=e.data.likePost;V(h(h({},I),{},{liked:!I.liked,likes:t.post.likers.length}))}))},onMouseOver:function(){return _(!0)},onMouseOut:function(){return _(!1)}},w?I.liked?m.a.createElement(v,{className:"like-icon"}):m.a.createElement(g,{className:"like-icon"}):I.liked?m.a.createElement(g,{className:"like-icon"}):m.a.createElement(v,{className:"like-icon"}),I.likes>0&&I.likes),m.a.createElement("span",{className:"like"},m.a.createElement(p.Link,{to:"/post/".concat(o),className:"like-icon"},m.a.createElement(O,null)),I.comments>0&&I.comments)),E&&m.a.createElement("span",{className:"comment-form"},m.a.createElement("form",{onSubmit:function(e){e.preventDefault(),z({variables:{id:o,comment:S},update:function(e,t){var n=t.data;if(e){var a=e.readQuery({query:d.GET_POST,variables:{id:o}}).postComments;if(console.log(a),a){var s=h(h({},a),{},{edges:[{__typename:"CommentNodeConnection",node:n.createComment.comment}].concat(r()(a.edges))});e.writeQuery({query:d.GET_POST,variables:{id:o},data:{postComments:s}})}}}})},className:"form-group comment-form"},m.a.createElement("input",{className:"form-control",type:"text",id:"comment",name:"text",value:S,onChange:function(e){return H(e.target.value)}}),m.a.createElement("button",{className:"btn btn-teal",type:"submit",id:"btn"},"Comment")))))}}}]);
//# sourceMappingURL=3.main.js.map