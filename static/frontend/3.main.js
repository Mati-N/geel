(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"./src/components/post/PostItem.js":
/*!*****************************************!*\
  !*** ./src/components/post/PostItem.js ***!
  \*****************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var a=n(/*! @babel/runtime/helpers/toConsumableArray */"./node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n(/*! @babel/runtime/helpers/defineProperty */"./node_modules/@babel/runtime/helpers/defineProperty.js"),s=n.n(o),c=n(/*! @babel/runtime/helpers/slicedToArray */"./node_modules/@babel/runtime/helpers/slicedToArray.js"),l=n.n(c),i=n(/*! react */"./node_modules/react/index.js"),m=n.n(i),u=n(/*! @apollo/client */"./node_modules/@apollo/client/index.js"),d=n(/*! ../../Queries */"./src/Queries.js"),p=n(/*! react-router-dom */"./node_modules/react-router-dom/esm/react-router-dom.js"),f=n(/*! react-spring */"./node_modules/react-spring/web.js");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=Object(i.lazy)((function(){return n.e(/*! import() */11).then(n.bind(null,/*! ../SVG/Like.svg */"./src/components/SVG/Like.svg"))})),v=Object(i.lazy)((function(){return n.e(/*! import() */10).then(n.bind(null,/*! ../SVG/Heart.svg */"./src/components/SVG/Heart.svg"))})),O=Object(i.lazy)((function(){return n.e(/*! import() */9).then(n.bind(null,/*! ../SVG/Comments.svg */"./src/components/SVG/Comments.svg"))}));t.default=function(e){var t=e.text,n=e.title,a=e.username,o=e.id,s=e.likes,c=e.creation,b=e.user_id,j={done:!1,likes:s,hasMore:!1,height:"32vh",loading:!1,comments:e.comments,expand:!1},y=Object(u.useLazyQuery)(d.LIKED,{variables:{post_id:o},onCompleted:function(e){A(h(h({},Q),{},{liked:e.liked}))}}),E=l()(y,1)[0],k=Object(i.useState)(!1),x=l()(k,2),N=x[0],M=x[1],w=Object(i.useState)(""),_=l()(w,2),C=_[0],P=_[1],S=Object(i.useRef)(null),H=Object(u.useMutation)(d.LIKE),D=l()(H,1)[0],T=Object(u.useMutation)(d.CREATE_COMMENT),L=l()(T,1)[0],G=Object(i.useState)(j),z=l()(G,2),Q=z[0],A=z[1],I=Object(f.useSpring)({to:{maxHeight:Q.expand?"".concat(S.current.scrollHeight,"px"):"230px",height:Q.expand?"".concat(S.current.scrollHeight,"px"):"230px"},from:{maxHeight:Q.expand?"".concat(S.current.scrollHeight,"px"):"230px",height:Q.expand?"".concat(S.current.scrollHeight,"px"):"230px"},duration:"1s"});Object(i.useEffect)((function(){E(),A(h(h({},Q),{},{hasMore:S.current.scrollHeight>S.current.clientHeight,loading:!1}))}),[]);return m.a.createElement("div",{className:"post card"},m.a.createElement("div",{className:"post-top card-top"},m.a.createElement("div",{className:"post-info-top"},m.a.createElement(p.Link,{to:"user/".concat(b),className:"post-user"}," ",a," "),m.a.createElement("small",{className:"post-time"},function(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var a=Math.floor(n);return Math.floor(n)+(1===a?" year":" years")}if((n=t/2592e3)>1){var r=Math.floor(n);return r+(1===r?" month":" months")}if((n=t/86400)>1){var o=Math.floor(n);return Math.floor(o)+(1===o?" day":" days")}if((n=t/3600)>1){var s=Math.floor(n);return s+(1===s?" hour":" hours")}if((n=t/60)>1){var c=Math.floor(n);return c+(1==c?" minute":" minutes")}return"Seconds"}(new Date(c))," ago"," ")),m.a.createElement("h5",{className:"post-title"},n)),m.a.createElement(f.animated.pre,{ref:S,className:"post-text",style:Q.hasMore?I:{}},t,Q.hasMore&&m.a.createElement("button",{className:"more",onClick:function(){A(h(h({},Q),{},{expand:!Q.expand}))}},Q.expand?"less":"more")),!Q.loading&&m.a.createElement("div",{className:"info-bottom"},m.a.createElement("span",{className:"like",onClick:function(){D({variables:{post_id:o}}).catch((function(e){return console.log(e)})).then((function(e){var t=e.data.likePost;A(h(h({},Q),{},{liked:!Q.liked,likes:t.post.likers.length}))}))},onMouseOver:function(){return M(!0)},onMouseOut:function(){return M(!1)}},N?Q.liked?m.a.createElement(v,{className:"like-icon"}):m.a.createElement(g,{className:"like-icon"}):Q.liked?m.a.createElement(g,{className:"like-icon"}):m.a.createElement(v,{className:"like-icon"}),Q.likes>0&&Q.likes),m.a.createElement("span",{className:"like"},m.a.createElement(p.Link,{to:"/post/".concat(o),className:"like-icon"},m.a.createElement(O,null)),Q.comments>0&&Q.comments),m.a.createElement("span",null,m.a.createElement("form",{className:"cfrm",method:"post",onSubmit:function(){L({variables:{id:o,content:C},update:function(e,t){var n=t.data;if(e){var a=e.readQuery({query:d.GET_POST,variables:{id:o}}).postComments;if(a){var s=h(h({},a),{},{edges:[{__typename:"CommentNodeConnection",node:n.createComment.comment}].concat(r()(a.edges))});e.writeQuery({query:d.GET_POST,variables:{id:o},data:{postComments:s}})}}}})}},m.a.createElement("div",{className:"form-group comment-form"},m.a.createElement("input",{class:"form-control",type:"text",id:"comment",name:"text",value:C,onChange:function(e){return P(e.target.value)}}),m.a.createElement("button",{class:"btn btn-outline-primary",type:"submit",id:"btn",disabled:!0},"Comment"))))))}}}]);
//# sourceMappingURL=3.main.js.map