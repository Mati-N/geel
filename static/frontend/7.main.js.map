{"version":3,"sources":["webpack:///./node_modules/@material-ui/icons/CommentTwoTone.js","webpack:///./node_modules/@material-ui/icons/Favorite.js","webpack:///./node_modules/@material-ui/icons/FavoriteTwoTone.js","webpack:///./src/components/post/PostItem.js"],"names":["_interopRequireDefault","Object","defineProperty","exports","value","default","_react","_default","createElement","Fragment","d","opacity","PostItem","text","title","username","id","likeCount","createdAt","user_id","commentCount","show_comment","imagePath","initialState","done","likes","hasMore","height","loading","comments","expand","liked","useLazyQuery","LIKED","variables","post_id","onCompleted","data","setState","state","pollInterval","useState","comment","setComment","self","useRef","likePost","useMutation","LIKE","addComment","CREATE_COMMENT","expandText","useSpring","to","current","scrollHeight","from","duration","useEffect","clientHeight","style","maxHeight","like","error","console","log","then","post","className","alt","src","variant","margin","date","seconds","Math","floor","Date","interval","flr","timeSince","pre","ref","onClick","minWidth","color","startIcon","onSubmit","e","preventDefault","update","cache","postComments","readQuery","query","GET_POST","newData","edges","__typename","node","createComment","writeQuery","type","name","onChange","target"],"mappings":";;;;2DAEA,IAAIA,EAAyB,qDAAQ,kEAErCC,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,aAAU,EAElB,IAAIC,EAASN,EAAuB,cAAQ,kCAIxCO,GAAW,EAFMP,EAAuB,8BAAQ,6DAElBK,SAASC,EAAOD,QAAQG,cAAcF,EAAOD,QAAQI,SAAU,KAAMH,EAAOD,QAAQG,cAAc,OAAQ,CAC1IE,EAAG,gFACHC,QAAS,OACPL,EAAOD,QAAQG,cAAc,OAAQ,CACvCE,EAAG,+IACA,kBAELP,EAAQE,QAAUE,G;;;;2DClBlB,IAAIP,EAAyB,qDAAQ,kEAErCC,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,aAAU,EAElB,IAAIC,EAASN,EAAuB,cAAQ,kCAIxCO,GAAW,EAFMP,EAAuB,8BAAQ,6DAElBK,SAASC,EAAOD,QAAQG,cAAc,OAAQ,CAC9EE,EAAG,mLACD,YAEJP,EAAQE,QAAUE,G;;;;2DCflB,IAAIP,EAAyB,qDAAQ,kEAErCC,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,aAAU,EAElB,IAAIC,EAASN,EAAuB,cAAQ,kCAIxCO,GAAW,EAFMP,EAAuB,8BAAQ,6DAElBK,SAASC,EAAOD,QAAQG,cAAcF,EAAOD,QAAQI,SAAU,KAAMH,EAAOD,QAAQG,cAAc,OAAQ,CAC1IE,EAAG,0KACHC,QAAS,OACPL,EAAOD,QAAQG,cAAc,OAAQ,CACvCE,EAAG,6VACA,mBAELP,EAAQE,QAAUE,G;;;;g0FC0OHK,UAnPE,SAAC,GAWZ,IAVJC,EAUI,EAVJA,KACAC,EASI,EATJA,MACAC,EAQI,EARJA,SACAC,EAOI,EAPJA,GACAC,EAMI,EANJA,UACAC,EAKI,EALJA,UACAC,EAII,EAJJA,QACAC,EAGI,EAHJA,aACAC,EAEI,EAFJA,aACAC,EACI,EADJA,UAEMC,EAAe,CACnBC,MAAM,EACNC,MAAOR,EACPS,SAAS,EACTC,OAAQ,OACRC,SAAS,EACTC,SAAUT,EACVU,QAAQ,GAEHC,EAVH,EAUYC,uBAAaC,QAAO,CAClCC,UAAW,CAAEC,QAASnB,GACtBoB,YAAa,SAACC,GACZC,EAAS,EAAD,KAAMC,GAAN,IAAaR,MAAOM,EAAKN,UAEnCS,aAAc,MAfZ,UAkB0BC,oBAAS,GAlBnC,kBAmB0BA,mBAAS,IAnBnC,IAmBGC,EAnBH,KAmBYC,EAnBZ,KAoBEC,EAAOC,iBAAO,MAEbC,EAtBH,EAsBeC,sBAAYC,QAtB3B,MAuBGC,EAvBH,EAuBiBF,sBAAYG,kBAvB7B,UAwBsBT,mBAASlB,GAxB/B,GAwBGgB,EAxBH,KAwBUD,EAxBV,KA0BEa,EAAaC,oBAAU,CAC3BC,GAAI,CACF1B,OAAQY,EAAMT,OAAN,UAAkBc,EAAKU,QAAQC,aAA/B,MAAkD,SAE5DC,KAAM,CACJ7B,OAASY,EAAMT,OAAP,UAA6Bc,EAAKU,QAAQC,aAA1C,MAAgB,SAE1BE,SAAU,SAGZC,qBAAU,WACR3B,IACA,IAAML,EAAUkB,EAAKU,QAAQC,aAAeX,EAAKU,QAAQK,aACrDjC,IACFkB,EAAKU,QAAQM,MAAMC,UAAY,OAC/BjB,EAAKU,QAAQM,MAAMjC,OAAS,SAE9BW,EAAS,EAAD,KACHC,GADG,IAENb,UACAE,SAAS,OAEV,IAEH,IAmCMkC,EAAO,WACXhB,EAAS,CAAEZ,UAAW,CAAEC,QAASnB,KAAjC,OACS,SAAC+C,GAAD,OAAWC,QAAQC,IAAIF,MAC7BG,MAAK,YAA4B,IAAjBpB,EAAiB,EAAzBT,KAAQS,SACfR,EAAS,EAAD,KACHC,GADG,IAENR,OAAQQ,EAAMR,MACdN,MAAOqB,EAASqB,KAAKlD,iBAsC7B,OACE,yBAAKmD,UAAU,aACb,yBAAKA,UAAU,qBACb,yBAAKA,UAAU,iBACb,kBAAC,OAAD,CAAMf,GAAE,gBAAWlC,GAAWiD,UAAU,aACtC,kBAAC,UAAD,CACEC,IAAKtD,EACLuD,IAAKhD,EACLiD,QAAQ,SACRX,MAAO,CACLY,OAAQ,WAET,IACFzD,EAAU,KAEb,2BAAOqD,UAAU,aA/FP,SAACK,GACjB,IAAIC,EAAUC,KAAKC,OAAO,IAAIC,KAASJ,GAAQ,KAE3CK,EAAWJ,EAAU,QACzB,GAAII,EAAW,EAAG,CAChB,IAAMC,EAAMJ,KAAKC,MAAME,GACvB,OAAOH,KAAKC,MAAME,IAAqB,IAARC,EAAY,QAAU,UAIvD,IADAD,EAAWJ,EAAU,QACN,EAAG,CAChB,IAAMK,EAAMJ,KAAKC,MAAME,GACvB,OAAOC,GAAe,IAARA,EAAY,SAAW,WAIvC,IADAD,EAAWJ,EAAU,OACN,EAAG,CAChB,IAAMK,EAAMJ,KAAKC,MAAME,GACvB,OAAOH,KAAKC,MAAMG,IAAgB,IAARA,EAAY,OAAS,SAIjD,IADAD,EAAWJ,EAAU,MACN,EAAG,CAChB,IAAMK,EAAMJ,KAAKC,MAAME,GACvB,OAAOC,GAAe,IAARA,EAAY,QAAU,UAItC,IADAD,EAAWJ,EAAU,IACN,EAAG,CAChB,IAAMK,EAAMJ,KAAKC,MAAME,GACvB,OAAOC,GAAc,GAAPA,EAAW,UAAY,YAEvC,MAAO,UAgEEC,CAAU,IAAIH,KAAK3D,IADtB,OACuC,MAGzC,wBAAIkD,UAAU,cAActD,IAE9B,kBAAC,WAASmE,IAAV,CACEC,IAAKtC,EACLwB,UAAS,YACTR,MAAOrB,EAAMb,QAAUyB,EAAa,IAEnCtC,EACA0B,EAAMb,SACL,4BACE0C,UAAU,OACVe,QAAS,WACP7C,EAAS,EAAD,KAAMC,GAAN,IAAaT,QAASS,EAAMT,YAGrCS,EAAMT,OAAS,OAAS,UAI7BS,EAAMX,SACN,oCACE,yBAAKwC,UAAU,eACb,0BACEA,UAAU,OACVe,QAAS,WACPrB,MAGF,kBAAC,UAAD,CACEM,UAAU,mBACVR,MAAO,CAAEwB,SAAU,OACnBb,QAAQ,YACRc,MAAM,UACNC,UACEvD,EACE,kBAAC,IAAD,CAAcsD,MAAM,WAEpB,kBAAC,IAAD,MAGJF,QAASrB,GAERvB,EAAMd,MAAQ,GAAKc,EAAMd,QAG9B,0BAAM2C,UAAU,QACd,kBAAC,OAAD,CAAMf,GAAE,gBAAWrC,IACjB,kBAAC,UAAD,CACEoD,UAAU,mBACVR,MAAO,CAAEwB,SAAU,OACnBb,QAAQ,YACRc,MAAM,UACNC,UAAW,kBAAC,IAAD,OAEV/C,EAAMV,SAAW,GAAKU,EAAMV,aAMpCR,GACC,0BAAM+C,UAAU,gBACd,0BAAMmB,SAnHE,SAACC,GACnBA,EAAEC,iBACFxC,EAAW,CACTf,UAAW,CAAElB,KAAI0B,WACjBgD,OAAQ,SAACC,EAAD,GAAqB,IAAXtD,EAAW,EAAXA,KAChB,GAAIsD,EAAO,KACHC,EAAiBD,EAAME,UAAU,CACrCC,MAAOC,WACP7D,UAAW,CAAElB,QAFT4E,aAIN,GAAIA,EAAc,CAChB,IAAMI,EAAU,EAAH,KACRJ,GADQ,IAEXK,MAAO,CACL,CACEC,WAAY,wBACZC,KAAM9D,EAAK+D,cAAc1D,UAHxB,SAKAkD,EAAaK,UAGpBN,EAAMU,WAAW,CACfP,MAAOC,WACP7D,UAAW,CAAElB,MACbqB,KAAM,CACJuD,aAAcI,WA0Fa5B,UAAU,2BACrC,2BACEA,UAAU,eACVkC,KAAK,OACLtF,GAAG,UACHuF,KAAK,OACLnG,MAAOsC,EACP8D,SAAU,SAAChB,GAAD,OAAO7C,EAAW6C,EAAEiB,OAAOrG,UAEvC,4BAAQgE,UAAU,eAAekC,KAAK,SAAStF,GAAG,OAAlD","file":"7.main.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(_react.default.Fragment, null, _react.default.createElement(\"path\", {\n  d: \"M20 17.17V4H4v12h14.83L20 17.17zM18 14H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z\",\n  opacity: \".3\"\n}), _react.default.createElement(\"path\", {\n  d: \"M4 18h14l4 4-.01-18c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2zM4 4h16v13.17L18.83 16H4V4zm2 8h12v2H6zm0-3h12v2H6zm0-3h12v2H6z\"\n})), 'CommentTwoTone');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"\n}), 'Favorite');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(_react.default.Fragment, null, _react.default.createElement(\"path\", {\n  d: \"M16.5 5c-1.54 0-3.04.99-3.56 2.36h-1.87C10.54 5.99 9.04 5 7.5 5 5.5 5 4 6.5 4 8.5c0 2.89 3.14 5.74 7.9 10.05l.1.1.1-.1C16.86 14.24 20 11.39 20 8.5c0-2-1.5-3.5-3.5-3.5z\",\n  opacity: \".3\"\n}), _react.default.createElement(\"path\", {\n  d: \"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z\"\n})), 'FavoriteTwoTone');\n\nexports.default = _default;","import React, { useState, useEffect, useRef, lazy } from \"react\";\r\nimport { useLazyQuery, useMutation } from \"@apollo/client\";\r\nimport { LIKED, LIKE, CREATE_COMMENT, GET_POST } from \"../../Queries\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSpring, animated } from \"react-spring\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport FavoriteTwoToneIcon from \"@material-ui/icons/FavoriteTwoTone\";\r\nimport CommentTwoToneIcon from \"@material-ui/icons/CommentTwoTone\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\r\n\r\nconst PostItem = ({\r\n  text,\r\n  title,\r\n  username,\r\n  id,\r\n  likeCount,\r\n  createdAt,\r\n  user_id,\r\n  commentCount,\r\n  show_comment,\r\n  imagePath,\r\n}) => {\r\n  const initialState = {\r\n    done: false,\r\n    likes: likeCount,\r\n    hasMore: false,\r\n    height: \"32vh\",\r\n    loading: true,\r\n    comments: commentCount,\r\n    expand: false,\r\n  };\r\n  const [liked] = useLazyQuery(LIKED, {\r\n    variables: { post_id: id },\r\n    onCompleted: (data) => {\r\n      setState({ ...state, liked: data.liked });\r\n    },\r\n    pollInterval: 2000,\r\n  });\r\n\r\n  const [hovered, setHovered] = useState(false);\r\n  const [comment, setComment] = useState(\"\");\r\n  const self = useRef(null);\r\n\r\n  const [likePost] = useMutation(LIKE);\r\n  const [addComment] = useMutation(CREATE_COMMENT);\r\n  const [state, setState] = useState(initialState);\r\n\r\n  const expandText = useSpring({\r\n    to: {\r\n      height: state.expand ? `${self.current.scrollHeight}px` : \"230px\",\r\n    },\r\n    from: {\r\n      height: !state.expand ? \"230px\" : `${self.current.scrollHeight}px`,\r\n    },\r\n    duration: \"0.9s\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    liked();\r\n    const hasMore = self.current.scrollHeight > self.current.clientHeight;\r\n    if (hasMore) {\r\n      self.current.style.maxHeight = \"none\";\r\n      self.current.style.height = \"230px\";\r\n    }\r\n    setState({\r\n      ...state,\r\n      hasMore,\r\n      loading: false,\r\n    });\r\n  }, []);\r\n\r\n  const timeSince = (date) => {\r\n    let seconds = Math.floor((new Date() - date) / 1000);\r\n\r\n    let interval = seconds / 31536000;\r\n    if (interval > 1) {\r\n      const flr = Math.floor(interval);\r\n      return Math.floor(interval) + (flr === 1 ? \" year\" : \" years\");\r\n    }\r\n\r\n    interval = seconds / 2592000;\r\n    if (interval > 1) {\r\n      const flr = Math.floor(interval);\r\n      return flr + (flr === 1 ? \" month\" : \" months\");\r\n    }\r\n\r\n    interval = seconds / 86400;\r\n    if (interval > 1) {\r\n      const flr = Math.floor(interval);\r\n      return Math.floor(flr) + (flr === 1 ? \" day\" : \" days\");\r\n    }\r\n\r\n    interval = seconds / 3600;\r\n    if (interval > 1) {\r\n      const flr = Math.floor(interval);\r\n      return flr + (flr === 1 ? \" hour\" : \" hours\");\r\n    }\r\n\r\n    interval = seconds / 60;\r\n    if (interval > 1) {\r\n      const flr = Math.floor(interval);\r\n      return flr + (flr == 1 ? \" minute\" : \" minutes\");\r\n    }\r\n    return \"Seconds\";\r\n  };\r\n\r\n  const like = () => {\r\n    likePost({ variables: { post_id: id } })\r\n      .catch((error) => console.log(error))\r\n      .then(({ data: { likePost } }) => {\r\n        setState({\r\n          ...state,\r\n          liked: !state.liked,\r\n          likes: likePost.post.likeCount,\r\n        });\r\n      });\r\n  };\r\n  const add_comment = (e) => {\r\n    e.preventDefault();\r\n    addComment({\r\n      variables: { id, comment },\r\n      update: (cache, { data }) => {\r\n        if (cache) {\r\n          let { postComments } = cache.readQuery({\r\n            query: GET_POST,\r\n            variables: { id },\r\n          });\r\n          if (postComments) {\r\n            const newData = {\r\n              ...postComments,\r\n              edges: [\r\n                {\r\n                  __typename: \"CommentNodeConnection\",\r\n                  node: data.createComment.comment,\r\n                },\r\n                ...postComments.edges,\r\n              ],\r\n            };\r\n            cache.writeQuery({\r\n              query: GET_POST,\r\n              variables: { id },\r\n              data: {\r\n                postComments: newData,\r\n              },\r\n            });\r\n          }\r\n        }\r\n      },\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"post card\">\r\n      <div className=\"post-top card-top\">\r\n        <div className=\"post-info-top\">\r\n          <Link to={`/user/${user_id}`} className=\"post-user\">\r\n            <Avatar\r\n              alt={username}\r\n              src={imagePath}\r\n              variant=\"circle\"\r\n              style={{\r\n                margin: \"0.4em\",\r\n              }}\r\n            />{\" \"}\r\n            {username}{\" \"}\r\n          </Link>\r\n          <small className=\"post-time\">\r\n            {timeSince(new Date(createdAt))} ago{\" \"}\r\n          </small>\r\n        </div>\r\n        <h5 className=\"post-title\">{title}</h5>\r\n      </div>\r\n      <animated.pre\r\n        ref={self}\r\n        className={`post-text`}\r\n        style={state.hasMore ? expandText : {}}\r\n      >\r\n        {text}\r\n        {state.hasMore && (\r\n          <button\r\n            className=\"more\"\r\n            onClick={() => {\r\n              setState({ ...state, expand: !state.expand });\r\n            }}\r\n          >\r\n            {state.expand ? \"less\" : \"more\"}\r\n          </button>\r\n        )}\r\n      </animated.pre>\r\n      {!state.loading && (\r\n        <>\r\n          <div className=\"info-bottom\">\r\n            <span\r\n              className=\"like\"\r\n              onClick={() => {\r\n                like();\r\n              }}\r\n            >\r\n              <Button\r\n                className=\"mx-auto d-block \"\r\n                style={{ minWidth: \"25%\" }}\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                startIcon={\r\n                  liked ? (\r\n                    <FavoriteIcon color=\"action\" />\r\n                  ) : (\r\n                    <FavoriteTwoToneIcon />\r\n                  )\r\n                }\r\n                onClick={like}\r\n              >\r\n                {state.likes > 0 && state.likes}\r\n              </Button>\r\n            </span>\r\n            <span className=\"like\">\r\n              <Link to={`/post/${id}`}>\r\n                <Button\r\n                  className=\"mx-auto d-block \"\r\n                  style={{ minWidth: \"25%\" }}\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                  startIcon={<CommentTwoToneIcon />}\r\n                >\r\n                  {state.comments > 0 && state.comments}\r\n                </Button>\r\n              </Link>\r\n            </span>\r\n          </div>\r\n\r\n          {show_comment && (\r\n            <span className=\"comment-form\">\r\n              <form onSubmit={add_comment} className=\"form-group comment-form\">\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  id=\"comment\"\r\n                  name=\"text\"\r\n                  value={comment}\r\n                  onChange={(e) => setComment(e.target.value)}\r\n                />\r\n                <button className=\"btn btn-teal\" type=\"submit\" id=\"btn\">\r\n                  Comment\r\n                </button>\r\n              </form>\r\n            </span>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostItem;\r\n"],"sourceRoot":""}